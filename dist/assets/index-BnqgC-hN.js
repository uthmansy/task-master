(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function s(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(t){if(t.ep)return;t.ep=!0;const o=s(t);fetch(t.href,o)}})();const r="https://server-g4w265rdq-uthmansys-projects.vercel.app/api";async function f(n,e){const s=await fetch(`${r}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:e})});return s.ok?(await s.json()).token:(alert("Login failed"),null)}async function y(n,e,s){return(await fetch(`${r}/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:s,name:n})})).ok?!0:(alert("Registration failed"),!1)}async function g(n){const e=await fetch(`${r}/tasks/get`,{headers:{Authorization:`Bearer ${n}`}});return e.ok?e.json():(alert("Failed to fetch tasks"),[])}async function h(n,e){await fetch(`${r}/tasks/create`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify(e)})}async function k(n,e){console.log(e),console.log(n);const s=await fetch(`${r}/tasks/search`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({query:e})});return s.ok?s.json():(alert("Failed to search tasks"),[])}async function B(n,e){(await fetch(`${r}/tasks/complete`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({taskId:e})})).ok||alert("Failed to mark task as completed")}async function v(n,e){console.log(e),(await fetch(`${r}/tasks/delete`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({taskId:e})})).ok||alert("Failed to delete task")}const I=document.getElementById("auth"),w=document.getElementById("tasks"),E=document.getElementById("loginBtn"),T=document.getElementById("registerBtn"),$=document.getElementById("addTaskBtn"),b=document.getElementById("email"),S=document.getElementById("search"),O=document.getElementById("search-btn"),L=document.getElementById("emailRegister"),P=document.getElementById("name"),j=document.getElementById("password"),N=document.getElementById("passwordRegister"),u=document.getElementById("taskTitle"),p=document.getElementById("taskDescription"),m=document.getElementById("priority"),A=document.getElementById("date"),D=document.getElementById("taskList");let a=null;function C(n){const e=new Date(n);if(isNaN(e.getTime()))throw new Error("Invalid date string");const s=String(e.getDate()).padStart(2,"0"),i=String(e.getMonth()+1).padStart(2,"0"),t=e.getFullYear();return`${s}-${i}-${t}`}function R(){I.style.display="none",w.style.display="block",d()}async function d(n=null){if(!a)return;let e;n?e=await k(a,n):e=await g(a),D.innerHTML=e.map(t=>`
        <div class="task">
          <div class="taskContant"><span>${t.title}</span><span>${t.description}</span><span>
        ${t.priority}
      </span><span>
        Deadline: ${t.date&&C(t.date)}
      </span><span>
        ${t.completed?"completed":"uncompleted"}
      </span></div>
          ${t.completed?"":`<button data-id="${t._id}" class="complete-btn">Mark as Completed</button>`}
          ${`<button data-id="${t._id}" class="delete-btn">Delete</button>`}
        </div>
      `).join("");const s=document.querySelectorAll(".complete-btn"),i=document.querySelectorAll(".delete-btn");s.forEach(t=>{t.addEventListener("click",async o=>{const c=o.target.dataset.id;a&&c&&(await B(a,c),d())})}),i.forEach(t=>{t.addEventListener("click",async o=>{const c=o.target.dataset.id;console.log(c),a&&c&&(await v(a,c),d())})})}E.addEventListener("click",async()=>{const n=b.value,e=j.value;a=await f(n,e),a&&R()});O.addEventListener("click",async()=>{const n=S.value;a&&n&&d(n)});T.addEventListener("click",async()=>{const n=P.value,e=L.value,s=N.value;await y(n,e,s)&&alert("Registration successful! Please login.")});$.addEventListener("click",async()=>{const n={title:u.value,description:p.value,date:A.value,priority:m.value};a&&n&&(await h(a,n),u.value="",p.value="",m.value="",d())});
